(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d4b8c94"],{"0012":function(t,e,i){},"11c8":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"g",(function(){return a})),i.d(e,"i",(function(){return r})),i.d(e,"c",(function(){return s})),i.d(e,"k",(function(){return c})),i.d(e,"a",(function(){return u})),i.d(e,"h",(function(){return l})),i.d(e,"j",(function(){return d})),i.d(e,"m",(function(){return f})),i.d(e,"d",(function(){return p})),i.d(e,"e",(function(){return g})),i.d(e,"f",(function(){return h})),i.d(e,"l",(function(){return m}));var o=i("b775");function n(t){return o["a"].get("categories",{params:t})}function a(t){return o["a"].post("categories",t)}function r(t){return o["a"].delete("categories/".concat(t))}function s(t,e){return o["a"].patch("categories/".concat(t),e)}function c(t){return o["a"].get("products",{params:t})}function u(t){return o["a"].post("products/destroy",t)}function l(t){return o["a"].post("products",t)}function d(t){return o["a"].delete("products/".concat(t))}function f(t){return o["a"].get("products/".concat(t))}function p(t,e){return o["a"].patch("products/".concat(t),e)}function g(t){return o["a"].post("products/audit",t)}function h(t){return o["a"].post("products/change_status",t)}function m(){return o["a"].get("qiniu/token")}},"1b29":function(t,e,i){"use strict";var o=i("3812"),n=i.n(o);n.a},2341:function(t,e,i){"use strict";var o=i("2de7"),n=i.n(o);n.a},"2de7":function(t,e,i){},3812:function(t,e,i){},"66ea":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dialog-container"},[i("div",{staticClass:"searchInput"},[i("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索","suffix-icon":"el-icon-search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.child.goodList.filter((function(e){return!t.search||e.name.includes(t.search)})),"default-sort":{prop:"price",order:"descending"}}},[i("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"price",label:"价格",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"sale",label:"销量",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"chooseStatus",label:"选择"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.currentId===e.row.id?i("el-button",{class:t.currentId===e.row.id?"choose":"",attrs:{type:"text",size:"small"},on:{click:function(){return t.SingleOperation(e.row.id)}}},[t._v("已选择")]):t._e(),t._v(" "),t.currentId!==e.row.id?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return t.SingleOperation(e.row.id)}}},[t._v("选择")]):t._e()]}}])})],1),t._v(" "),t.child.total?i("div",{staticClass:"pagingBox"},[i("el-pagination",{attrs:{"current-page":t.child.searchOption.pagination.currentPage,"page-sizes":t.child.searchOption.pagination.mode,"page-size":t.child.searchOption.pagination.defaultMode,background:"","prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper",total:t.child.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],1)},n=[],a=(i("c5f6"),i("f8a4")),r=i("5f87"),s={props:{child:{type:Object,required:!0}},data:function(){return{search:"",tableData:[],currentId:"",company_id:""}},created:function(){var t=Object(r["a"])();this.company_id=JSON.parse(t).id,this.getDetails(),this.getProList()},methods:{SingleOperation:function(t){this.$emit("sendChildData",t),this.currentId=t},handleCurrentChange:function(t){console.log(t),this.child.searchOption.pagination.currentPage=t,this.getProList()},getDetails:function(){void 0!==this.child.chooseId&&(this.currentId=this.child.chooseId)},getProList:function(){var t=this,e={type:"",search:"",company_id:this.company_id,status:"up",page:this.child.searchOption.pagination.currentPage,per_page:15};Object(a["t"])(e).then((function(e){console.log(e),t.child.goodList=e.data,t.child.total=Number(e.headers["x-total"])}))}}},c=s,u=(i("de9b"),i("2877")),l=Object(u["a"])(c,o,n,!1,null,"16aa538f",null);e["a"]=l.exports},"6dca":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("TopTitle",{attrs:{title:t.title}}),t._v(" "),i("div",{staticClass:"EditMain"},[i("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"任务时间",required:""}},[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{prop:"valid_from"}},[i("el-date-picker",{staticStyle:{},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择开始日期","picker-options":t.pickerOptionsStart},model:{value:t.form.valid_from,callback:function(e){t.$set(t.form,"valid_from",e)},expression:"form.valid_from"}})],1)],1),t._v(" "),i("el-col",{staticClass:"line",attrs:{span:1}},[t._v("至")]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{prop:"valid_to"}},[i("el-date-picker",{staticStyle:{},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择结束日期","picker-options":t.pickerOptionsEnd},model:{value:t.form.valid_to,callback:function(e){t.$set(t.form,"valid_to",e)},expression:"form.valid_to"}})],1)],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"剩余金币",prop:"residue_coin"}},[i("el-input",{staticStyle:{width:"600px"},attrs:{type:"number"},model:{value:t.form.residue_coin,callback:function(e){t.$set(t.form,"residue_coin",e)},expression:"form.residue_coin"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"选择商品",required:""}},[i("el-button",{on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("+从商品库中选择")])],1),t._v(" "),i("el-form-item",{attrs:{label:"展示图",required:""}},[i("MyUpload",{ref:"uploads",attrs:{"file-size":1e3,"fixed-size":!1,size:{width:300,height:300},proportion:{width:2,height:1},"file-limit":1,"images-list":t.imagesFiles}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addStore("form")}}},[t._v("提交审核")]),t._v(" "),i("el-button",{on:{click:t.goBack}},[t._v("取消")]),t._v(" "),i("el-button",[t._v("预览")])],1)],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"选择商品",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[i("choose-good",{attrs:{child:t.form.tableData},on:{sendChildData:t.getChildData}}),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.clearData}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("确 定")])],1)],1)],1)},n=[],a=(i("c5f6"),i("7b94")),r=i("66ea"),s=i("a796"),c=i("f8a4"),u=i("5f87"),l={components:{TopTitle:a["a"],chooseGood:r["a"],MyUpload:s["a"]},data:function(){var t=this;return{title:"",dialogTableVisible:!1,form:{residue_coin:"",valid_from:"",valid_to:"",tableData:{goodList:[],chooseId:"",searchOption:{pagination:{currentPage:1,mode:[10,20,50,100],defaultMode:10}},total:100},company_id:"",product_id:"",goodsImageUrlList:""},pickerOptionsStart:{disabledDate:function(e){if(t.form.valid_to)return e.getTime()>new Date(t.form.valid_to).getTime()}},pickerOptionsEnd:{disabledDate:function(e){if(t.form.valid_from)return e.getTime()<new Date(t.form.valid_from).getTime()-864e5}},imagesFiles:[],rules:{valid_from:[{required:!0,message:"请选择开始日期",trigger:"change"}],valid_to:[{required:!0,message:"请选择结束日期",trigger:"change"}],residue_coin:[{required:!0,message:"请填写金币数",trigger:"blur"}]}}},created:function(){var t=Object(u["a"])();this.company_id=JSON.parse(t).id,this.getDetails()},methods:{getDetails:function(){var t=this;if(void 0!==this.$route.query.id){this.title="编辑商品任务";var e=this.$route.query.id;Object(c["s"])(e).then((function(e){console.log(e),t.form.residue_coin=e.data.residue_coin,t.form.valid_from=e.data.valid_from,t.form.valid_to=e.data.valid_to,t.form.tableData.chooseId=e.data.product.id,t.product_id=e.data.product.id,t.imagesFiles.push(e.data.image)}))}else this.title="添加商品任务"},addStore:function(t){var e=this;console.log(t,this.$refs.uploads.images),this.$refs[t].validate((function(t){if(!t)return!1;if(console.log(e.product_id),!e.product_id)return e.$message.error("请选择商品"),!1;if(0===e.$refs.uploads.images.length)return e.$message.error("请上传图片"),!1;var i={product_id:e.product_id,image:e.$refs.uploads.images[0],coin:e.form.residue_coin,valid_from:e.form.valid_from,valid_to:e.form.valid_to},o=e.$qs.stringify(i);if(void 0===e.$route.query.id)Object(c["e"])(o).then((function(t){console.log(t),e.$message({message:"添加成功",type:"success"}),e.$router.go(-1)}));else{var n=e.$route.query.id;Object(c["z"])(n,o).then((function(t){console.log(t),e.$message({message:"修改成功",type:"success"}),e.$router.go(-1)}))}}))},goBack:function(){this.resetForm("form"),this.$router.go(-1)},getProList:function(){var t=this,e={type:"",search:"",company_id:this.company_id,status:"up",page:1,per_page:15};Object(c["t"])(e).then((function(e){console.log(e),t.form.tableData.goodList=e.data,t.form.tableData.total=Number(e.headers["x-total"])}))},getChildData:function(t){console.log(t),this.product_id=t},clearData:function(){this.product_id="",this.dialogTableVisible=!1},resetForm:function(t){this.$refs[t].resetFields()}}},d=l,f=(i("7abde"),i("2877")),p=Object(f["a"])(d,o,n,!1,null,"3978c9be",null);e["default"]=p.exports},"7abde":function(t,e,i){"use strict";var o=i("0012"),n=i.n(o);n.a},"7b94":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"topTitle"},[i("span"),i("span",{staticClass:"title"},[t._v(t._s(t.title))])])},n=[],a={props:{title:{type:String,required:!0}},data:function(){return{}}},r=a,s=(i("1b29"),i("2877")),c=Object(s["a"])(r,o,n,!1,null,"b4ebadd8",null);e["a"]=c.exports},a796:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.disabled?i("div",[i("img",{staticClass:"goodsPhone",attrs:{src:t.$commonImg}})]):i("el-upload",{attrs:{data:t.QiniuData,"before-upload":t.beforeAvatarUpload,"on-remove":t.handleRemove,"on-success":t.handleAvatarSuccess,"file-list":t.formOption.goodsImageList,limit:t.fileLimit,"on-exceed":t.handleExceed,action:"https://upload-z2.qiniup.com","list-type":"picture-card"}},[i("i",{staticClass:"el-icon-plus"}),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n      "+t._s(t.fixedSize?"图片尺寸"+t.size.width+"*"+t.size.height+"px ，大小不超过"+t.fileSize+"k":"图片比例必须是"+t.proportion.width+"（宽）："+t.proportion.height+"（高），大小不超过"+t.fileSize+"k")+"\n    ")])])],1)},n=[],a=(i("28a5"),i("7f7f"),i("ac6a"),i("c5f6"),i("11c8")),r=i("5f87"),s={props:{size:{type:Object,required:!0},fixedSize:{type:Boolean,required:!0},proportion:{type:Object,required:!0},fileSize:{type:Number,required:!0},fileLimit:{type:Number,required:!0},imagesList:{type:Array,required:!0}},data:function(){return{BASE_API:Object({NODE_ENV:"production",VUE_APP_BASE_API:"https://api.shjietui.com",BASE_URL:"/"}).BASE_API,images:[],formOption:{goodsClassifyOneSelectList:[],goodsClassifyTwoSelectList:[],hasModifyGoodsImage:"",goodsImageList:[]},disabled:!1,QiniuData:{key:"",token:""},uploadPicUrl:"",qiniuaddr:"http://file.shjietui.com/"}},watch:{imagesList:{handler:function(){var t=this;this.imagesList&&this.imagesList.length>0&&this.imagesList.forEach((function(e){var i={name:"aaa",url:e.image_path};t.formOption.goodsImageList.push(i),t.images.push(e.file_path)}))},deep:!0}},created:function(){var t=this;this.$nextTick((function(){console.log(t.imagesList),t.imagesList&&t.imagesList.length>0&&t.imagesList.forEach((function(e){var i={name:"aaa",url:e.image_path};t.formOption.goodsImageList.push(i),t.images.push(e.file_path)}))}))},mounted:function(){var t=this;Object(a["l"])().then((function(e){t.QiniuData.token=e.data.qiniu_token}))},methods:{handleAvatarSuccessSpecifications:function(t,e,i,o){console.log("文件上传成功:"),console.log(t),console.log(e),console.log(i),console.log(o),"000"===t.code?this.$set(this.formData.specificationsList[o],"thumbnailUrl",t.data):this.$message.error(t.message)},beforeAvatarUploadSpecifications:function(t){console.log("上传文件之前:");var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("上传图片只能是 JPG/PNG 格式!"),e},beforeAvatarUpload:function(t){var e=this;console.log("上传文件之前:");var i="image/jpeg"===t.type||"image/png"===t.type,o=t.size/1024<this.fileSize;i||this.$message.error("上传图片只能是 JPG/PNG 格式!"),o||this.$message.error("上传图片大小不能超过 ".concat(this.fileSize,"KB!"));var n=new Promise((function(i,o){if(e.fixedSize){var n=Number(e.size.width),a=Number(e.size.height),r=window.URL||window.webkitURL,s=new Image;s.onload=function(){var t=s.width===n&&s.height===a;console.log("valid:"),console.log(t),t?i():o()},s.src=r.createObjectURL(t)}else{var c=Number(e.proportion.width),u=Number(e.proportion.height),l=window.URL||window.webkitURL,d=new Image;d.onload=function(){console.log(d.width/d.height),console.log(c/u);var t=d.width/d.height===c/u;console.log("valid:"),console.log(t),t?i():o()},d.src=l.createObjectURL(t)}})).then((function(){return t}),(function(){return e.fixedSize?e.$message.error("上传的图片大小必须是".concat(e.size.width,"*").concat(e.size.height,"!")):e.$message.error("上传的图片尺寸必须是".concat(e.proportion.width,"（宽）：").concat(e.proportion.height,"（高）!")),Promise.reject()}));return this.QiniuData.key="".concat(Object(r["c"])()).concat(t.name),i&&o&&n},handleAvatarSuccess:function(t,e,i){console.log("文件上传成功:"),console.log(t),console.log(e),console.log(i),this.uploadPicUrl="".concat(t.key),console.log(this.uploadPicUrl);var o=[];console.log(i),i.forEach((function(t){"aaa"===t.name?o.push(t.url.split("//")[1].split("/")[1]):o.push("".concat(t.response.key))})),this.images=o,this.formOption.hasModifyGoodsImage=!0},handleRemove:function(t,e){console.log("文件列表移除文件:");var i=[];console.log(e),e.forEach((function(t){"aaa"===t.name?i.push(t.url.split("//")[1].split("/")[1]):i.push("".concat(t.response.key))})),this.images=i,this.formOption.hasModifyGoodsImage=!0},handleExceed:function(t,e){console.log("文件超出个数限:"),this.$message.warning("当前限制选择 ".concat(this.fileLimit," 个文件，本次选择了 ").concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))}}},c=s,u=(i("2341"),i("2877")),l=Object(u["a"])(c,o,n,!1,null,null,null);e["a"]=l.exports},de9b:function(t,e,i){"use strict";var o=i("fde3"),n=i.n(o);n.a},f8a4:function(t,e,i){"use strict";i.d(e,"u",(function(){return n})),i.d(e,"t",(function(){return a})),i.d(e,"e",(function(){return r})),i.d(e,"s",(function(){return s})),i.d(e,"z",(function(){return c})),i.d(e,"j",(function(){return u})),i.d(e,"l",(function(){return l})),i.d(e,"a",(function(){return d})),i.d(e,"k",(function(){return f})),i.d(e,"v",(function(){return p})),i.d(e,"f",(function(){return g})),i.d(e,"p",(function(){return h})),i.d(e,"c",(function(){return m})),i.d(e,"o",(function(){return _})),i.d(e,"x",(function(){return v})),i.d(e,"h",(function(){return b})),i.d(e,"n",(function(){return y})),i.d(e,"b",(function(){return k})),i.d(e,"m",(function(){return w})),i.d(e,"w",(function(){return O})),i.d(e,"A",(function(){return S})),i.d(e,"g",(function(){return L})),i.d(e,"r",(function(){return $})),i.d(e,"d",(function(){return x})),i.d(e,"q",(function(){return q})),i.d(e,"y",(function(){return z})),i.d(e,"i",(function(){return j}));var o=i("b775");function n(t){return o["a"].get("task_products",{params:t})}function a(t){return o["a"].get("products",{params:t})}function r(t){return o["a"].post("task_products",t)}function s(t){return o["a"].get("task_products/".concat(t))}function c(t,e){return o["a"].patch("task_products/".concat(t),e)}function u(t){return o["a"].delete("task_products/".concat(t))}function l(t){return o["a"].get("task_articles",{params:t})}function d(t){return o["a"].post("task_articles",t)}function f(t){return o["a"].get("task_articles/".concat(t))}function p(t,e){return o["a"].patch("task_articles/".concat(t),e)}function g(t){return o["a"].delete("task_articles/".concat(t))}function h(t){return o["a"].get("task_questionnaires",{params:t})}function m(t){return o["a"].post("task_questionnaires",t)}function _(t){return o["a"].get("task_questionnaires/".concat(t))}function v(t,e){return o["a"].patch("task_questionnaires/".concat(t),e)}function b(t){return o["a"].delete("task_questionnaires/".concat(t))}function y(t){return o["a"].get("task_game",{params:t})}function k(t){return o["a"].post("task_game",t)}function w(t){return o["a"].get("task_game/".concat(t))}function O(t,e){return o["a"].patch("task_game/".concat(t),e)}function S(t){return o["a"].post("tasks/audit",t)}function L(t){return o["a"].delete("task_game/".concat(t))}function $(t){return o["a"].get("task_links",{params:t})}function x(t){return o["a"].post("task_links",t)}function q(t){return o["a"].get("task_links/".concat(t))}function z(t,e){return o["a"].patch("task_links/".concat(t),e)}function j(t){return o["a"].delete("task_links/".concat(t))}},fde3:function(t,e,i){}}]);