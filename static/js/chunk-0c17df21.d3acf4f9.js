(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c17df21","chunk-600fd891"],{"11c8":function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"h",(function(){return r})),n.d(e,"j",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"l",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"i",(function(){return l})),n.d(e,"k",(function(){return f})),n.d(e,"n",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return m})),n.d(e,"g",(function(){return g})),n.d(e,"m",(function(){return h})),n.d(e,"a",(function(){return _}));var i=n("b775");function a(t){return i["a"].get("categories",{params:t})}function r(t){return i["a"].post("categories",t)}function o(t){return i["a"].delete("categories/".concat(t))}function s(t,e){return i["a"].patch("categories/".concat(t),e)}function u(t){return i["a"].get("products",{params:t})}function c(t){return i["a"].post("products/destroy",t)}function l(t){return i["a"].post("products",t)}function f(t){return i["a"].delete("products/".concat(t))}function d(t){return i["a"].get("products/".concat(t))}function p(t,e){return i["a"].patch("products/".concat(t),e)}function m(t){return i["a"].post("products/audit",t)}function g(t){return i["a"].post("products/change_status",t)}function h(){return i["a"].get("qiniu/token")}function _(t){return i["a"].post("products/".concat(t.id,"/apply"))}},"1b29":function(t,e,n){"use strict";var i=n("3812"),a=n.n(i);a.a},2341:function(t,e,n){"use strict";var i=n("2de7"),a=n.n(i);a.a},"2de7":function(t,e,n){},3812:function(t,e,n){},"61a9f":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("TopTitle",{attrs:{title:t.title}}),t._v(" "),n("div",{staticClass:"EditMain"},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"任务时间",required:""}},[n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{prop:"valid_from"}},[n("el-date-picker",{staticStyle:{},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择开始日期","picker-options":t.pickerOptionsStart},model:{value:t.form.valid_from,callback:function(e){t.$set(t.form,"valid_from",e)},expression:"form.valid_from"}})],1)],1),t._v(" "),n("el-col",{staticClass:"line",attrs:{span:1}},[t._v("至")]),t._v(" "),n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{prop:"valid_to"}},[n("el-date-picker",{staticStyle:{},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择结束日期","picker-options":t.pickerOptionsEnd},model:{value:t.form.valid_to,callback:function(e){t.$set(t.form,"valid_to",e)},expression:"form.valid_to"}})],1)],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"金币总数",prop:"residue_coin"}},[n("el-input",{staticStyle:{width:"600px"},attrs:{type:"number"},model:{value:t.form.residue_coin,callback:function(e){t.$set(t.form,"residue_coin",e)},expression:"form.residue_coin"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"问卷标题",prop:"name"}},[n("el-input",{staticStyle:{width:"600px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{staticStyle:{width:"600px",resize:"none"},attrs:{type:"textarea",rows:4},model:{value:t.form.questionnaire.desc,callback:function(e){t.$set(t.form.questionnaire,"desc",e)},expression:"form.questionnaire.desc"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"问卷内容"}},[t._l(t.form.questionnaire.questions,(function(e,i){return n("div",{key:i,staticClass:"questionList"},[n("el-row",[n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{label:"Q1","label-width":"30px"}},[n("el-input",{model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:5}},[n("el-select",{attrs:{placeholder:"请选择问题格式"},on:{change:function(n){return t.changeSelect(i,e.type)}},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"item.type"}},[n("el-option",{attrs:{label:"单选",value:"Question::Single"}}),t._v(" "),n("el-option",{attrs:{label:"多选",value:"Question::Multiple"}}),t._v(" "),n("el-option",{attrs:{label:"文本",value:"Question::Completion"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:1}},[n("i",{staticClass:"el-icon-delete",on:{click:function(){return t.deleteQuestion(i)}}})])],1),t._v(" "),n("el-row",t._l(e.options,(function(e,i){return n("el-col",{key:i,attrs:{span:6}},[n("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"选项"+(i+1),"label-width":"60px"}},[n("el-input",{model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item2.name"}})],1)],1)})),1),t._v(" "),n("el-row",["Question::Completion"!==e.type?n("div",{staticClass:"formNotice",on:{click:function(){return t.addOptions(i)}}},[t._v("+添加选项"),n("span",[t._v("最多添加10个选项")])]):t._e()])],1)})),t._v(" "),n("div",{staticClass:"formNotice",staticStyle:{"margin-top":"10px"},on:{click:function(){return t.addQuestions()}}},[t._v("+添加问题"),n("span",[t._v("最多添加10个问题")])])],2),t._v(" "),n("el-form-item",{attrs:{label:"展示图",required:"",prop:"image"}},[n("MyUpload",{ref:"uploads",attrs:{"file-size":1e3,"fixed-size":!1,size:{width:300,height:300},proportion:{width:1,height:1},"file-limit":1,"images-list":t.imagesFiles}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交审核")]),t._v(" "),n("el-button",{on:{click:t.back}},[t._v("取消")])],1)],1)],1)],1)},a=[],r=(n("7f7f"),n("ac6a"),n("7b94")),o=n("a796"),s=n("f8a4"),u={components:{TopTitle:r["a"],MyUpload:o["a"]},data:function(){var t=this;return{title:"",form:{residue_coin:"",valid_from:"",valid_to:"",goodsImageUrlList:"",name:"",questionnaire:{desc:"",questions:[]},image:""},pickerOptionsStart:{disabledDate:function(e){if(t.form.valid_to)return e.getTime()>new Date(t.form.valid_to).getTime()}},pickerOptionsEnd:{disabledDate:function(e){if(t.form.valid_from)return e.getTime()<new Date(t.form.valid_from).getTime()-864e5}},imagesFiles:[],rules:{valid_from:[{required:!0,message:"请选择开始日期",trigger:"change"}],valid_to:[{required:!0,message:"请选择结束日期",trigger:"change"}],residue_coin:[{required:!0,message:"请填写金币数",trigger:"blur"}],name:[{required:!0,message:"请填写问卷标题",trigger:"blur"}],image:[{required:!0,message:"请选择任务图片",trigger:"blur"}]}}},created:function(){this.getDetail()},methods:{handleClick:function(t,e){},go_prize:function(){this.$router.push({path:"businessPrizeManagement"})},onSubmit:function(){var t=this;this.form.image=this.$refs.uploads.images[0],this.$refs["form"].validate((function(e,n){if(e){var i=JSON.parse(JSON.stringify(t.form.questionnaire.questions)),a=!1;if(i.forEach((function(t){for(var e in t)""===t[e]&&(a=!0),Array.isArray(t[e])&&t[e].length>0&&t[e].forEach((function(t,e){""===t.name&&(a=!0)}))})),a)return t.$message.error("请完善问卷题目");if(i.forEach((function(t,e){var n=[];t.options.forEach((function(t,e){n.push(t.name)})),t.options=n})),void 0===t.$route.query.id){var r=new FormData;r.append("name",t.form.name),r.append("desc",t.form.questionnaire.desc),r.append("questions",JSON.stringify(i)),r.append("coin",t.form.residue_coin),r.append("valid_from",t.form.valid_from),r.append("valid_to",t.form.valid_to),r.append("image",t.form.image),Object(s["c"])(r).then((function(e){200===e.status&&(t.$message({message:"添加成功",type:"success"}),t.$router.go(-1))}))}else{var o=t.$route.query.id,u=new FormData;u.append("name",t.form.name),u.append("desc",t.form.questionnaire.desc),u.append("questions",JSON.stringify(i)),u.append("coin",t.form.residue_coin),u.append("valid_from",t.form.valid_from),u.append("valid_to",t.form.valid_to),u.append("image",t.form.image),Object(s["A"])(o,u).then((function(e){200===e.status&&(t.$message({message:"修改成功",type:"success"}),t.$router.go(-1))}))}}}))},getDetail:function(){var t=this;if(void 0!==this.$route.query.id){this.title="编辑调查问卷";var e=this.$route.query.id;Object(s["o"])(e).then((function(e){200===e.status&&(t.form=e.data,t.form.residue_coin=e.data.coin,t.imagesFiles.push(e.data.image))}))}else this.title="发布调查问卷"},addOptions:function(t){this.form.questionnaire.questions[t].options.length<10?this.form.questionnaire.questions[t].options.push({name:""}):this.$message.error("最多添加10个选项！")},addQuestions:function(){this.form.questionnaire.questions.length<10?this.form.questionnaire.questions.push({name:"",options:[{name:""}],type:""}):this.$message.error("最多添加10个问题！")},changeSelect:function(t,e){"Question::Completion"===e&&(this.form.questionnaire.questions[t].options=[])},deleteQuestion:function(t){this.form.questionnaire.questions.splice(t,1)},back:function(){this.$router.go(-1)}}},c=u,l=(n("d833f"),n("2877")),f=Object(l["a"])(c,i,a,!1,null,"f63eb9da",null);e["default"]=f.exports},"7b94":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topTitle"},[n("span"),n("span",{staticClass:"title"},[t._v(t._s(t.title))])])},a=[],r={props:{title:{type:String,required:!0}},data:function(){return{}}},o=r,s=(n("1b29"),n("2877")),u=Object(s["a"])(o,i,a,!1,null,"b4ebadd8",null);e["a"]=u.exports},a796:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.disabled?n("div",[n("img",{staticClass:"goodsPhone",attrs:{src:t.$commonImg}})]):n("el-upload",{attrs:{data:t.QiniuData,"before-upload":t.beforeAvatarUpload,"on-remove":t.handleRemove,"on-success":t.handleAvatarSuccess,"file-list":t.formOption.goodsImageList,limit:t.fileLimit,"on-exceed":t.handleExceed,action:"https://upload-z2.qiniup.com","list-type":"picture-card"}},[n("i",{staticClass:"el-icon-plus"}),t._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n      "+t._s(t.fixedSize?"建议图片尺寸"+t.size.width+"*"+t.size.height+"px ，大小不超过"+t.fileSize+"k":"建议图片比例是"+t.proportion.width+"（宽）："+t.proportion.height+"（高），大小不超过"+t.fileSize+"k")+"\n    ")])])],1)},a=[],r=(n("28a5"),n("7f7f"),n("ac6a"),n("c5f6"),n("11c8")),o=n("5f87"),s={props:{size:{type:Object,required:!0},fixedSize:{type:Boolean,required:!0},proportion:{type:Object,required:!0},fileSize:{type:Number,required:!0},fileLimit:{type:Number,required:!0},imagesList:{type:Array,required:!0}},data:function(){return{BASE_API:Object({NODE_ENV:"production",VUE_APP_BASE_API:"https://api.shjietui.com",BASE_URL:"/"}).BASE_API,images:[],formOption:{goodsClassifyOneSelectList:[],goodsClassifyTwoSelectList:[],hasModifyGoodsImage:"",goodsImageList:[]},disabled:!1,QiniuData:{key:"",token:""},uploadPicUrl:"",qiniuaddr:"http://file.shjietui.com/"}},watch:{imagesList:{handler:function(){var t=this;this.imagesList&&this.imagesList.length>0&&(this.images=[],this.formOption.goodsImageList=[],this.imagesList.forEach((function(e){var n={name:"aaa",url:e.image_path};t.formOption.goodsImageList.push(n),t.images.push(e.file_path)})))},deep:!0}},created:function(){var t=this;this.$nextTick((function(){console.log(t.imagesList),t.imagesList&&t.imagesList.length>0&&t.imagesList.forEach((function(e){var n={name:"aaa",url:e.image_path};t.formOption.goodsImageList.push(n),t.images.push(e.file_path)}))}))},mounted:function(){var t=this;Object(r["m"])().then((function(e){200===e.status&&(t.QiniuData.token=e.data.qiniu_token)}))},methods:{handleAvatarSuccessSpecifications:function(t,e,n,i){"000"===t.code?this.$set(this.formData.specificationsList[i],"thumbnailUrl",t.data):this.$message.error(t.message)},beforeAvatarUploadSpecifications:function(t){console.log("上传文件之前:");var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("上传图片只能是 JPG/PNG 格式!"),e},beforeAvatarUpload:function(t){console.log("上传文件之前:");var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("上传图片只能是 JPG/PNG 格式!"),this.QiniuData.key="".concat(Object(o["c"])()).concat(t.name),e},handleAvatarSuccess:function(t,e,n){this.uploadPicUrl="".concat(t.key);var i=[];n.forEach((function(t){"aaa"===t.name?i.push(t.url.split("//")[1].split("/")[1]):i.push("".concat(t.response.key))})),this.images=i,this.formOption.hasModifyGoodsImage=!0},handleRemove:function(t,e){var n=[];e.forEach((function(t){"aaa"===t.name?n.push(t.url.split("//")[1].split("/")[1]):n.push("".concat(t.response.key))})),this.images=n,this.formOption.hasModifyGoodsImage=!0},handleExceed:function(t,e){this.$message.warning("当前限制选择 ".concat(this.fileLimit," 个文件，本次选择了 ").concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))}}},u=s,c=(n("2341"),n("2877")),l=Object(c["a"])(u,i,a,!1,null,null,null);e["a"]=l.exports},d217:function(t,e,n){},d833f:function(t,e,n){"use strict";var i=n("d217"),a=n.n(i);a.a},f8a4:function(t,e,n){"use strict";n.d(e,"x",(function(){return a})),n.d(e,"v",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"u",(function(){return s})),n.d(e,"C",(function(){return u})),n.d(e,"j",(function(){return c})),n.d(e,"l",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"k",(function(){return d})),n.d(e,"y",(function(){return p})),n.d(e,"f",(function(){return m})),n.d(e,"p",(function(){return g})),n.d(e,"c",(function(){return h})),n.d(e,"o",(function(){return _})),n.d(e,"A",(function(){return v})),n.d(e,"h",(function(){return k})),n.d(e,"n",(function(){return y})),n.d(e,"b",(function(){return b})),n.d(e,"m",(function(){return q})),n.d(e,"z",(function(){return S})),n.d(e,"D",(function(){return $})),n.d(e,"g",(function(){return O})),n.d(e,"r",(function(){return x})),n.d(e,"d",(function(){return w})),n.d(e,"q",(function(){return E})),n.d(e,"B",(function(){return L})),n.d(e,"i",(function(){return A})),n.d(e,"w",(function(){return C})),n.d(e,"t",(function(){return z})),n.d(e,"s",(function(){return j}));var i=n("b775");function a(t){return i["a"].get("task_products",{params:t})}function r(t){return i["a"].get("products",{params:t})}function o(t){return i["a"].post("task_products",t)}function s(t){return i["a"].get("task_products/".concat(t))}function u(t,e){return i["a"].patch("task_products/".concat(t),e)}function c(t){return i["a"].delete("task_products/".concat(t))}function l(t){return i["a"].get("task_articles",{params:t})}function f(t){return i["a"].post("task_articles",t)}function d(t){return i["a"].get("task_articles/".concat(t))}function p(t,e){return i["a"].patch("task_articles/".concat(t),e)}function m(t){return i["a"].delete("task_articles/".concat(t))}function g(t){return i["a"].get("task_questionnaires",{params:t})}function h(t){return i["a"].post("task_questionnaires",t)}function _(t){return i["a"].get("task_questionnaires/".concat(t))}function v(t,e){return i["a"].patch("task_questionnaires/".concat(t),e)}function k(t){return i["a"].delete("task_questionnaires/".concat(t))}function y(t){return i["a"].get("task_game",{params:t})}function b(t){return i["a"].post("task_game",t)}function q(t){return i["a"].get("task_game/".concat(t))}function S(t,e){return i["a"].patch("task_game/".concat(t),e)}function $(t){return i["a"].post("tasks/audit",t)}function O(t){return i["a"].delete("task_game/".concat(t))}function x(t){return i["a"].get("task_links",{params:t})}function w(t){return i["a"].post("task_links",t)}function E(t){return i["a"].get("task_links/".concat(t))}function L(t,e){return i["a"].patch("task_links/".concat(t),e)}function A(t){return i["a"].delete("task_links/".concat(t))}function C(t,e){return i["a"].get("task_questionnaires/".concat(t,"/reply"),{params:e})}function z(t){return i["a"].get("task_game/".concat(t,"/prizes"))}function j(t,e){return i["a"].get("task_game/".concat(t,"/prize_logs"),{params:e})}}}]);